@csrf_exempt
def receive_data(request):
    if request.method == 'POST':
        try:
            data = json.loads(request.body)
            # Process and save data to the database
            print("Received data:", data)
            return JsonResponse({"status": "success", "message": "Data received"})
        except Exception as e:
            return JsonResponse({"status": "error", "message": str(e)}, status=400)
    return JsonResponse({"status": "error", "message": "Invalid request method"}, status=405)


path('api/receive-data/', receive_data, name='receive_data'),





class ReceiveDataView(APIView):
    def post(self, request, *args, **kwargs):
        try:
            # Parse JSON data from the request body
            data = request.data
            print("Received data:", data)

            # Process and save data to the database (add your logic here)

            # Return a success response
            return Response({"status": "success", "message": "Data received"}, status=status.HTTP_200_OK)
        except Exception as e:
            # Return an error response if something goes wrong
            return Response({"status": "error", "message": str(e)}, status=status.HTTP_400_BAD_REQUEST)

    path('api/receive-data/', ReceiveDataView.as_view(), name='receive_data'),




Failed to send data. Response code: 400
Error response: {"status":"error","message":"JSON parse error - Expecting value: line 1 column 77 (char 76)"}

@method_decorator(csrf_exempt, name='dispatch')

from django.utils.decorators import method_decorator
from django.views.decorators.csrf import csrf_exempt












@method_decorator(csrf_exempt, name='dispatch')
class ReceiveDataView(APIView):
    def post(self, request, *args, **kwargs):
        try:
            data = request.data
            print("Received data:", data)
            os_name = data.get("OS")
            os_version = data.get("version")
            os_architecture = data.get("osArch")
            service = data.get("services", [])

            print(f"OS: {os_name}")
            print(f"Version: {os_version}")
            print(f"Architecture: {os_architecture}")
            print(f"Services: {service}")


            return Response({
                "status": "success",
                "message": "Data received",
                "data": {
                    "OS": os_name,
                    "version": os_version,
                    "osArch": os_architecture,
                    "services": service

                }
            }, status=status.HTTP_200_OK)

        except Exception as e:
            return Response({
                "status": "error",
                "message": str(e)
            }, status=status.HTTP_400_BAD_REQUEST)
